<% layout('layout', { title: 'Available Jobs', user: user }) %>

<h2>Available Jobs</h2>

<ul>
  <% jobs.forEach(job => { %>
    <li>
      <h3><%= job.title %></h3>
      <p><strong>Category:</strong> <%= job.category %> | 
         <strong>Wage:</strong> <%= job.wage %></p>
      <p><%= job.description %></p>
      <p>
        <strong>Location:</strong> <%= job.location %> |
        <strong>Duration:</strong> <%= job.duration %>
      </p>
      <p><strong>Posted by:</strong> <%= job.client.displayName %></p>

      <% if (user && user.role === 'Freelancer') { %>
        <form action="/freelancer/apply" method="post" style="display:inline">
          <input type="hidden" name="jobId" value="<%= job.id %>">
          <button type="submit">Apply</button>
        </form>
      <% } %>

      <% if (user && user.role === 'Client') { %>
        <a href="/freelancer/job/<%= job.id %>">View Applications</a>
      <% } %>
    </li>
  <% }) %>
</ul>
